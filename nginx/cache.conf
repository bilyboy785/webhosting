location ^~ /errorpages/ {
    alias /var/www/errorpages/;
    internal;
}

error_page 400 /errorpages/HTTP400.html;
error_page 401 /errorpages/HTTP401.html;
error_page 402 /errorpages/HTTP402.html;
error_page 403 /errorpages/HTTP403.html;
error_page 404 /errorpages/HTTP404.html;
error_page 500 /errorpages/HTTP500.html;
error_page 501 /errorpages/HTTP501.html;
error_page 502 /errorpages/HTTP502.html;
error_page 503 /errorpages/HTTP503.html;

# Cache très long pour les assets versionnés (CSS, JS, images, fonts)
location ~* \.(?:jpg|jpeg|gif|png|svg|ico|webp|avif|ttf|ttc|otf|eot|woff|woff2)$ {
    expires 365d;
    add_header Cache-Control "public, max-age=31536000, immutable";
    access_log off;
    log_not_found off;
    try_files $uri =404;
}

# Cache css & js files
location ~* \.(?:css(\.map)?|js(\.map)?)$ {
    add_header "Access-Control-Allow-Origin" "*";
    access_log off;
    log_not_found off;
    expires 30d;
}
# CSS and Javascript send expires headers.
location ~* \.(?:css|js)$ {
  expires 1y;
  access_log off;
  add_header Cache-Control "public";
}

# HTML send expires headers.
location ~* \.(html)$ {
  expires 7d;
  access_log off;
  add_header Cache-Control "public";
}

# Cache long pour les fichiers médias WordPress
location ~* /wp-content/uploads/.*\.(?:jpg|jpeg|gif|png|webp|avif|svg|mp4|webm|ogg|mp3|wav|pdf)$ {
    expires 365d;
    add_header Cache-Control "public, max-age=31536000, immutable";
    access_log off;
    log_not_found off;
}

# Cache intermédiaire pour les fichiers générés (thèmes, plugins)
location ~* /wp-(content|includes)/.*\.(?:css|js)$ {
    expires 30d;
    add_header Cache-Control "public, max-age=2592000";
    access_log off;
    log_not_found off;
}

# Désactivation du cache pour les fichiers sensibles
location ~* \.(?:html|xml|json)$ {
    expires -1;
    add_header Cache-Control "no-store, no-cache, must-revalidate, proxy-revalidate";
}
